# Biodiversity assessment of deep-sea benthic communities in North Atlantic and Arctic sponge grounds using sponge DNA
Data and scripts needed to process the output of the demultiplexer for dada2 for the MiSeq run  by Arias & Gallego et al, 2023.

## How to use this repo

You can download the whole content of the repository as a zip file, or clone it if you have a git client

### Dependecies
The code here will run in UNIX and R. If using Windows, you have to install the WSL2 and select Ubuntu to run the Unix code (Only for `swarm`). You have to install swarm from [here](https://github.com/torognes/swarm).

Plenty of R packages to install. R itself was  v4.1.3. The R packages needed are:

  - tidyverse
  - here
  - DADA2
  - viridis
  - eDNAfuns (from yours [truly](github.com/ramongallego/eDNAfunctions))

## Raw fastq files

These are too big to post here. But you can download the already demultiplexed files from the SRA repository (url here).
Once demultiplexed and without the primer sequences inside, we used DADA2 to generate an abundance table of ASV and a fasta file with the ASV sequences. You can find this script in `analysis/dada2.clust.r`

## ASVs have some noise to them
Because they reflect the composition of the amplicons that entered the MiSeq, but does not take into account the *mutations* generated by the 35 PCR cycles that preceeded that. So, within each sample we ran 'swarm' with a radius of 1 (the idea being that artificial haplotypes will be collapsed within a sample). Find the script in `analysis/swarm.sh`

## From sequences to taxa
Asigning taxonomic identities to DNA sequences is a complicated process, full of decisions and prone to both uncertainties and improvements with time. Find our efforts in `analysis/taxonomic.id.r`. Or do you favourite annotation and tell us your results. Don't forget to like and subscribe.

## Stats and that
The statistical analysis requires a few input files (we provide them all; although some of them you can generate them with the scripts above). All input files are in `data/`. There are some analysis that require the ASV table (after swarm collapsing), but most of them use the taxa table, after removing Host DNA. All these will produce the figures from the Manuscript and the Supplementeary info.

